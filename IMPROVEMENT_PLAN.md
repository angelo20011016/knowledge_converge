# Video Knowledge Convergence - 開發計畫

這份文件記錄了專案下一階段的主要開發任務和功能規劃，旨在提升系統穩定性、擴充使用者功能並優化整體體驗。

---

## 第一階段：核心功能重構與穩定性 (上線前準備)

此階段的目標是鞏固核心功能，確保服務穩定可靠。

### 1. 移除主題搜尋功能
- **目標**: 簡化核心邏輯，專注於單一影片分析的體驗。
- **後端**:
  - 移除 `/api/start-topic-search` API 路由。
  - 移除 `main.py` 中的 `run_analysis` 函數及相關依賴模組 (如 `step1_get_10url`)。
- **前端**:
  - 移除觸發主題搜尋的 UI 介面。

### 2. 優化長影片處理能力
- **目標**: 解決處理長影片時可能因記憶體不足而崩潰的問題，並確認系統能穩定支援的影片長度。
- **實作**:
  - 在 `transcribe_wav.py` 中引入音訊分塊 (Chunking) 處理機制，避免一次性將整個音訊檔案載入記憶體。
  - 測試並標明系統在當前硬體配置下，建議的影片處理長度上限。
  - **[已完成]** `transcribe_wav.py` 已重構為分塊處理模式。

### 3. 確保任務與結果的正確對應
- **目標**: 確保每個分析請求 (`job_id`) 的結果都能準確無誤地回傳給發起請求的使用者。
- **實作**:
  - 將目前基於記憶體的全域變數 `JOBS` 遷移至資料庫管理 (例如 SQLite 中的 `Job` 資料表)，以持久化儲存任務狀態。

---

## 第二階段：使用者中心功能

此階段專注於建立使用者系統，提供個人化服務。

### 1. 實作 Google SSO 登入系統
- **目標**: 提供使用者一個快速、安全的登入方式。

### 2. 實作使用額度限制
- **目標**: 管理系統資源，並區分訪客與登入用戶的權限。
- **規格**:
  - **訪客 (未登入)**: 透過 IP 追蹤，每日可分析 **1** 次。
  - **登入使用者**: 每日可分析 **5** 次。
  - **額度重置**: 所有使用者的額度每日午夜自動重置。
  - **前端顯示**: 使用者登入後，在導航欄等顯眼位置顯示當日剩餘額度。

### 3. 個人化模板與歷史紀錄
- **目標**: 讓使用者可以管理自己的提示詞模板，並追蹤過去的分析紀錄。
- **模板功能 (Template)**:
  - 使用者登入後，可以建立、查看、編輯、刪除自己的提示詞模板。
  - 模板管理介面以**彈出式視窗 (Modal)** 形式呈現。
  - 使用者自訂的模板內容將以參數 `{USER_PROMPT}` 的形式**附加**到系統主提示詞中，而非直接取代。
- **歷史紀錄 (History)**:
  - 新增一個「歷史紀錄」頁面。
  - 使用者可以在此頁面看到自己所有分析任務的列表。
  - 提供下載單筆紀錄的「摘要」或「逐字稿」功能。

---

## 第三階段：使用者體驗與回饋

### 1. 實作「建議與回饋」功能
- **目標**: 提供使用者一個回報問題或提出建議的管道。
- **規格**:
  - 在介面上設置一個「建議/回饋」按鈕。
  - 點擊後以**彈出式視窗 (Modal)** 形式讓使用者輸入內容。
  - 提交的內容儲存至後端資料庫 (可建立一個新的 `Feedback` 資料表)。

---

## 通用需求 (貫穿所有階段)

### 1. 響應式網頁設計 (RWD)
- **目標**: 確保所有頁面和功能在桌面、平板、手機等不同尺寸的裝置上都有良好的顯示效果和操作體驗。
