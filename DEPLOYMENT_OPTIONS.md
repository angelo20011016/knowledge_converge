
# 雲端部署策略分析與建議

本文旨在為 "Video Knowledge Convergence" 專案分析不同的雲端部署策略，目標是最大化利用 GCP 免費體驗額度，學習對履歷有高價值的現代化技術，並確保學習成果在試用期結束後仍能被保存。

---

## 方案一：單一虛擬機 + Docker Compose (基礎方案)

這是我們最初討論的，也是最直接的部署方式。

- **架構**：
  1. 在 GCP 上建立一台 `e2-micro` 虛擬主機 (VM)。
  2. 在主機上安裝 Docker 和 Docker Compose。
  3. `git clone` 你的專案。
  4. 執行 `docker-compose up --build -d` 來啟動所有服務 (前端、後端、SQLite 資料庫檔案)。

- **優點**：
  - **簡單直觀**：與你的本地開發環境幾乎一模一樣，容易上手。
  - **成本極低**：`e2-micro` 主機在 GCP 的永久免費額度內，因此每月成本可接近 **$0**。
  - **部署快速**：對於熟悉 Docker 的開發者來說，啟動服務非常快。

- **缺點**：
  - **擴展性差**：所有服務都擠在同一台微型主機上，若未來流量增加，主機很快會不堪重負。
  - **高併發能力弱**：繼續使用 SQLite，在處理多個同時寫入請求時會有效能瓶頸。
  - **手動管理**：需要手動登入主機來部署或除錯。
  - **履歷價值有限**：這是比較傳統的部署方式。

- **適用情境**：個人專案、作品集展示、低流量內部工具。

---

## 方案二：現代化雲端原生部署 (Cloud Run + Cloud SQL)

這個方案完全擁抱「Serverless (無伺服器)」和「全託管服務」，讓你專注於程式碼而非底層機器。

- **架構**：
  1. **應用程式**：將 `frontend` 和 `backend` 分別打包成獨立的 Docker 映像檔，推送到 GCP 的 **Artifact Registry** (私有 Docker Hub)。
  2. **部署**：將這兩個映像檔分別部署到兩個獨立的 **Cloud Run** 服務上。
  3. **資料庫**：建立一個 **Cloud SQL** for PostgreSQL 的託管資料庫實例，並讓後端服務與之連接。
  4. **網路**：設定 GCP 的負載均衡器或 Cloud Run 的內建功能，將 `/api` 流量導向後端，其餘流量導向前端。

- **優點**：
  - **高擴展性**：Cloud Run 會根據你的流量，在幾秒內自動從 0 擴展到數百個服務實例，真正實現「用多少付多少」。
  - **高併發能力**：專業的 Cloud SQL 資料庫能輕鬆處理大量同時讀寫請求。
  - **全託管 (Fully Managed)**：無需管理作業系統或主機、網路設定，專注於程式碼即可。
  - **履歷價值極高**：這是目前市場上最主流、最受歡迎的雲端原生部署架構，能證明你掌握了 Serverless 和微服務等關鍵技能。

- **缺點**：
  - **成本較高**：主要是 Cloud SQL 的費用，即使是最小的實例，每月也需要約 $15 美元以上。
  - **設定較複雜**：初次設定需要理解多個 GCP 服務並設定它們之間的網路和權限。

- **適用情境**：任何正式的、面向公眾的線上服務、新創公司產品。

---

## 方案三：IaC 自動化部署 (Terraform + 方案二)

這是最專業的方案，它包含方案二的所有優點，更重要的是，它解決了你最擔心的問題。

- **架構**：
  - 與方案二完全相同，但所有雲端資源（Cloud Run, Cloud SQL, Artifact Registry 等）都不是用滑鼠點擊建立的，而是透過 **Terraform** 程式碼來定義和管理。

- **優點**：
  - **包含方案二的所有優點**。
  - **架構可保存、可重現**：**完美解決你擔心試用期結束後心血白費的問題**。所有設定都在程式碼裡 (`.tf` 檔)，你可以把它們存在 Git 中。即使 GCP 服務被關閉，你隨時可以用這些程式碼在任何 GCP 帳號下一鍵重建整個環境。
  - **版本控制**：你的雲端基礎設施可以像應用程式碼一樣，進行版本控制、審查和協作。
  - **履歷價值頂尖**：`Terraform` + `CI/CD` 是目前 DevOps 和後端領域最熱門的技能之一，是資深工程師和架構師的必備技能，是專業的終極證明。

- **缺點**：
  - **有學習曲線**：需要花一點時間學習 Terraform 的語法和概念。

- **適用情境**：所有專業的開發團隊，以及任何希望實現長期、穩定、可維護部署的專案。

---

## 總結與最終建議

**我強烈建議你直接挑戰【方案三】。**

雖然它看起來最複雜，但它能一步到位地讓你學到最有價值的現代化雲端技術，並且透過 Terraform (IaC) 的方式，讓你所有的學習成果（架構程式碼）都能被永久保存下來。你最終留下的 `Terraform` 程式碼，是比運行的服務本身更有價值的資產。

為了控制成本，我們可以分步進行：在學習初期，先用 Terraform 建立 Cloud Run，但暫時不建立 Cloud SQL，讓應用程式繼續使用打包在容器裡的 SQLite，這樣可以讓你熟悉流程的同時，將成本控制在 $0。當你準備好後，再用 Terraform 加入 Cloud SQL，真正開始消耗你的免費額度。

## 下一步行動 (Action)

如果你同意這個方向，我們的下一步將是：

1.  在你的專案中安裝 Terraform。
2.  建立第一個 Terraform 檔案 (`main.tf`)，設定 GCP 提供者 (Provider)。
3.  使用 Terraform 程式碼來定義第一個雲端資源：**Artifact Registry**，用它來存放你的 Docker 映像檔。
